<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .congrats {
            background-color: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.3em;
            margin-bottom: 20px;
        }
        .certificate {
            border: 5px solid #4CAF50;
            padding: 30px;
            text-align: center;
            background: #fff;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0px 0px 15px rgba(0,0,0,0.2);
        }
        .certificate img {
            max-width: 150px;
            margin-bottom: 15px;
        }
        .certificate h2 {
            margin-top: 10px;
            font-size: 28px;
            color: #4CAF50;
        }
        .certificate p {
            font-size: 18px;
            color: #333;
        }
        .retry-container {
            text-align: center;
            margin-top: 20px;
        }
        .retry-container a {
            display: inline-block;
            text-decoration: none;
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
        }
        .retry-container a:hover {
            background-color: #0056b3;
        }
        .share-btn {
            display: inline-block;
            background-color: #0A66C2;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
            margin-top: 15px;
        }
        .share-btn:hover {
            background-color: #084182;
        }
        .download-btn {
            display: inline-block;
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-decoration: none;
            margin-top: 15px;
        }
        .download-btn:hover {
            background-color: #1e7e34;
        }
    </style>
</head>
<body>
<div class="quiz-container">
    <h1>Quiz Results</h1>

    <div class="congrats">
        Your Score: {{ score }} / {{ total }}
    </div>

    {% if score >= (total * 0.7) %}
        <div class="certificate" id="certificate">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Academy Logo">
            <h2>Certificate of Achievement</h2>
            <p>This is to certify that you have <strong>successfully passed</strong> the Kubernetes Quiz.</p>
            <p><strong>Score:</strong> {{ score }} / {{ total }}</p>
            <p>Issued by Jeevi Academy</p>

            <!-- Download Certificate -->
            <a href="#" class="download-btn" onclick="downloadCertificate()">Download Certificate</a>

            <!-- LinkedIn Share -->
            <a class="share-btn" target="_blank" 
               href="https://www.linkedin.com/sharing/share-offsite/?url=https://jeeviacademy.com">
                Share on LinkedIn
            </a>
        </div>
    {% endif %}

    {% if incorrect_answers %}
        <div class="incorrect-answers">
            <h2>Incorrect Answers</h2>
            {% for ans in incorrect_answers %}
                <p>
                    <strong>Question:</strong> {{ ans.question }}<br>
                    <span class="correct-answer">✅ Correct Answer: {{ ans.correct }}</span>
                    <span class="your-answer">❌ Your Answer: {{ ans.yours }}</span>
                </p>
            {% endfor %}
        </div>
    {% endif %}

    <div class="retry-container">
        <a href="/">Try Again</a>
    </div>
</div>

<!-- html2canvas script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
function downloadCertificate() {
    const certDiv = document.getElementById('certificate');
    html2canvas(certDiv).then(canvas => {
        const link = document.createElement('a');
        link.download = 'certificate.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    });
}
</script>
</body>
</html>
